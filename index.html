<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Keynova Lock - Ù‚ÙÙ„ Ø¨ØµØ±ÙŠ Ø¢Ù…Ù†</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
<style>
:root {
--primary: #ff8800;
--primary-dark: #e67600;
--dark: #121212;
--dark-light: #1e1e1e;
--light: #f5f5f5;
--success: #00c853;
--danger: #ff4444;
--warning: #ffbb33;
--gray: #8d8d8d;
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Tajawal', Arial, sans-serif;
background-color: var(--dark);
color: var(--light);
min-height: 100vh;
padding: 20px;
direction: rtl;
text-align: right;
}

.container {
max-width: 500px;
margin: 0 auto;
padding: 20px;
}

header {
text-align: center;
padding: 20px 0 30px;
position: relative;
}

.logo {
background: linear-gradient(135deg, #ff8800, #ff5500);
width: 80px;
height: 80px;
border-radius: 50%;
margin: 0 auto 15px;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 5px 15px rgba(255, 136, 0, 0.3);
}

.logo i {
font-size: 36px;
color: white;
}

h1 {
color: var(--primary);
font-size: 28px;
margin-bottom: 5px;
}

.subtitle {
color: var(--gray);
font-size: 16px;
font-weight: 400;
}

.card {
background-color: var(--dark-light);
border-radius: 16px;
padding: 25px;
margin-bottom: 20px;
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
transition: all 0.3s ease;
border: 1px solid rgba(255, 255, 255, 0.05);
}

.card-header {
display: flex;
align-items: center;
margin-bottom: 20px;
color: var(--primary);
}

.card-header i {
font-size: 22px;
margin-left: 10px;
}

.card-header h3 {
font-size: 20px;
font-weight: 700;
}

.form-group {
margin-bottom: 20px;
}

.file-input {
width: 100%;
padding: 15px;
background-color: rgba(255, 255, 255, 0.05);
border: 1px solid rgba(255, 255, 255, 0.1);
border-radius: 10px;
color: var(--light);
font-size: 16px;
cursor: pointer;
transition: all 0.3s ease;
}

.file-input:hover {
border-color: var(--primary);
}

.file-input:focus {
outline: none;
border-color: var(--primary);
box-shadow: 0 0 0 2px rgba(255, 136, 0, 0.2);
}

.image-gallery {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
gap: 10px;
max-height: 300px;
overflow-y: auto;
padding: 10px;
background: rgba(255, 255, 255, 0.03);
border-radius: 10px;
border: 1px solid rgba(255, 255, 255, 0.1);
}

.image-item {
position: relative;
aspect-ratio: 1;
border-radius: 8px;
overflow: hidden;
cursor: pointer;
transition: all 0.3s ease;
border: 2px solid transparent;
}

.image-item:hover {
transform: scale(1.05);
border-color: var(--primary);
}

.image-item.selected {
border-color: var(--primary);
box-shadow: 0 0 10px rgba(255, 136, 0, 0.5);
}

.image-item img {
width: 100%;
height: 100%;
object-fit: cover;
}

.image-number {
position: absolute;
top: 5px;
right: 5px;
background: rgba(0, 0, 0, 0.7);
color: white;
border-radius: 50%;
width: 20px;
height: 20px;
display: flex;
align-items: center;
justify-content: center;
font-size: 12px;
font-weight: bold;
}

.image-name {
position: absolute;
bottom: 0;
left: 0;
right: 0;
background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
color: white;
padding: 8px 6px 6px;
font-size: 10px;
text-align: center;
opacity: 0;
transition: opacity 0.3s ease;
}

.image-item:hover .image-name {
opacity: 1;
}

.btn {
display: block;
width: 100%;
padding: 15px;
background: var(--primary);
color: white;
border: none;
border-radius: 10px;
font-size: 18px;
font-weight: 700;
cursor: pointer;
transition: all 0.3s ease;
margin-top: 10px;
text-align: center;
}

.btn:hover {
background: var(--primary-dark);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(255, 136, 0, 0.3);
}

.btn:active {
transform: translateY(0);
}

.btn-secondary {
background: rgba(255, 255, 255, 0.1);
}

.btn-secondary:hover {
background: rgba(255, 255, 255, 0.2);
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.btn-danger {
background: var(--danger);
}

.btn-danger:hover {
background: #e53935;
box-shadow: 0 5px 15px rgba(255, 68, 68, 0.3);
}

.btn-success {
background: var(--success);
}

.btn-success:hover {
background: #00b248;
box-shadow: 0 5px 15px rgba(0, 200, 83, 0.3);
}

select {
width: 100%;
padding: 15px;
background-color: rgba(255, 255, 255, 0.05);
border: 1px solid rgba(255, 255, 255, 0.1);
border-radius: 10px;
color: var(--light);
font-size: 16px;
margin-bottom: 15px;
}

select:focus {
outline: none;
border-color: var(--primary);
box-shadow: 0 0 0 2px rgba(255, 136, 0, 0.2);
}

.result {
padding: 15px;
border-radius: 10px;
margin-top: 20px;
text-align: center;
font-size: 18px;
font-weight: 500;
display: none;
}

.success {
background-color: rgba(0, 200, 83, 0.15);
color: #00ff99;
display: block;
}

.fail {
background-color: rgba(255, 68, 68, 0.15);
color: #ff4444;
display: block;
}

.warning {
background-color: rgba(255, 187, 51, 0.15);
color: #ffbb33;
display: block;
}

.hidden {
display: none;
}

.action-buttons {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 15px;
margin-top: 20px;
}

.action-buttons .btn {
margin: 0;
}

.session-timeout {
background: rgba(255, 187, 51, 0.1);
border: 1px solid rgba(255, 187, 51, 0.2);
padding: 10px;
border-radius: 10px;
text-align: center;
margin-top: 20px;
font-size: 14px;
color: var(--warning);
}

.instructions {
background: rgba(255, 255, 255, 0.03);
border-radius: 10px;
padding: 15px;
margin-top: 25px;
border-left: 3px solid var(--primary);
}

.instructions h4 {
color: var(--primary);
margin-bottom: 10px;
}

.instructions ul {
padding-right: 20px;
}

.instructions li {
margin-bottom: 8px;
color: var(--gray);
}

.tab-content {
display: none;
}

.active-tab {
display: block;
}

.tabs {
display: flex;
justify-content: space-between;
background: rgba(255, 255, 255, 0.05);
border-radius: 12px;
padding: 5px;
margin-bottom: 20px;
}

.tab-btn {
flex: 1;
padding: 12px;
text-align: center;
background: transparent;
color: var(--gray);
border: none;
border-radius: 10px;
cursor: pointer;
font-weight: 500;
transition: all 0.3s ease;
}

.tab-btn.active {
background: var(--primary);
color: white;
box-shadow: 0 4px 10px rgba(255, 136, 0, 0.3);
}

.status-icon {
margin-left: 10px;
}

.no-key-message {
text-align: center;
padding: 30px;
color: var(--warning);
}

.access-denied {
text-align: center;
padding: 30px;
color: var(--danger);
font-size: 18px;
}

.access-denied i {
font-size: 48px;
margin-bottom: 15px;
display: block;
}

@media (max-width: 480px) {
.container {
padding: 10px;
}

.card {
padding: 20px;
}

.action-buttons {
grid-template-columns: 1fr;
}

h1 {
font-size: 24px;
}

.card-header h3 {
font-size: 18px;
}

.image-gallery {
grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
}
}
</style>
</head>
<body>
<div class="container">
<header>
<div class="logo">
<i class="fas fa-lock"></i>
</div>
<h1>Keynova Lock</h1>
<p class="subtitle">Ù‚ÙÙ„ Ø¨ØµØ±ÙŠ Ø¢Ù…Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙˆØ± ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</p>
<p class="subtitle">Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…: Ø±Ø£ÙØª Ø¹Ù…Ø±</p>
</header>

<div class="tabs">
<button id="verify-tab" class="tab-btn active" onclick="openTab('verify')">ÙØªØ­ Ø§Ù„Ù‚ÙÙ„</button>
<button id="settings-tab" class="tab-btn" onclick="openTab('settings')">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
</div>

<!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ­Ù‚Ù‚ -->
<div id="verify" class="tab-content active-tab">
<div class="card">
<div class="card-header">
<i class="fas fa-unlock-alt"></i>
<h3>ÙØªØ­ Ø§Ù„Ù‚ÙÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙˆØ±Ø© ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
</div>

<div class="form-group">
<label style="color: var(--primary); margin-bottom: 10px; display: block; font-weight: 500;">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø©:</label>
<div class="image-gallery" id="verifyGallery">
<!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ± Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
</div>
</div>

<div class="form-group">
<label style="color: var(--primary); margin-bottom: 10px; display: block; font-weight: 500;">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
<input type="password" class="file-input" id="verifyPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="font-size: 16px;">
</div>

<button class="btn" onclick="verifyKey()">
<i class="fas fa-check-circle"></i> ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­
</button>

<div class="result" id="result"></div>
</div>

<div class="instructions">
<h4><i class="fas fa-info-circle"></i> ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù‡Ø§Ù…Ø©</h4>
<ul>
<li>Ø§Ø®ØªØ± Ù†ÙØ³ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡Ø§ ÙƒÙ…ÙØªØ§Ø­</li>
<li>Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„ØµØ­ÙŠØ­Ø© Ø§Ù„ØªÙŠ ØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡Ø§ Ù…Ø¹ Ø§Ù„ØµÙˆØ±Ø©</li>
<li>ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</li>
<li>Ø¥Ø°Ø§ Ù„Ù… ØªÙ†Ø¬Ø­ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</li>
</ul>
</div>
</div>

<!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
<div id="settings" class="tab-content">
<!-- Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯Ù…Ø§ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ -->
<div id="no-key-section" class="no-key-message hidden">
<i class="fas fa-key"></i>
<h3>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ Ù‚ÙÙ„ Ù…Ø­ÙÙˆØ¸</h3>
<p>ÙŠØ±Ø¬Ù‰ ÙØªØ­ Ø§Ù„Ù‚ÙÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„ØªØ¹ÙŠÙŠÙ† Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯</p>
</div>

<!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…ÙØªØ§Ø­ Ù…ØªØ§Ø­Ø§Ù‹ -->
<div id="settings-content" class="hidden">
<div class="card">
<div class="card-header">
<i class="fas fa-key"></i>
<h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙØªØ§Ø­</h3>
</div>

<div class="form-group">
<label style="color: var(--primary); margin-bottom: 10px; display: block; font-weight: 500;">Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø§Ù„Ù…ÙØªØ§Ø­:</label>
<div class="image-gallery" id="settingsGallery">
<!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ± Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
</div>
</div>

<div class="form-group">
<label style="color: var(--primary); margin-bottom: 10px; display: block; font-weight: 500;">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</label>
<input type="password" class="file-input" id="setKeyPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©" style="font-size: 16px;">
</div>

<button class="btn" onclick="setKey()">
<i class="fas fa-save"></i> ØªØ¹ÙŠÙŠÙ† Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯
</button>

<div class="action-buttons">
<button class="btn btn-danger" onclick="removeKey()">
<i class="fas fa-trash-alt"></i> Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØªØ§Ø­
</button>
</div>
</div>

<div class="card">
<div class="card-header">
<i class="fas fa-shield-alt"></i>
<h3>Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</h3>
</div>

<select id="protectedTarget">
<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù‡Ø¯Ù Ù„Ù„Ø­Ù…Ø§ÙŠØ© --</option>
<option value="images">ğŸ“¸ Ø§Ù„ØµÙˆØ±</option>
<option value="docs">ğŸ“„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</option>
<option value="apps">ğŸ“± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</option>
<option value="custom">ğŸ§© Ù…Ø®ØµØµ</option>
</select>

<div class="action-buttons">
<button class="btn btn-success" onclick="protectSelected()">
<i class="fas fa-lock"></i> ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ©
</button>
<button class="btn btn-secondary" onclick="clearProtection()">
<i class="fas fa-unlock"></i> Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ù…Ø§ÙŠØ©
</button>
</div>

<div class="result" id="protectionStatus"></div>
</div>
</div>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ -->
<div id="securedActions" class="hidden">
<div class="session-timeout">
<i class="fas fa-clock"></i> Ø§Ù„Ø¬Ù„Ø³Ø© Ø³ØªÙ†ØªÙ‡ÙŠ Ø®Ù„Ø§Ù„ <span id="sessionTimer">10:00</span>
</div>

<div class="action-buttons">
<button class="btn" onclick="openTab('settings')">
<i class="fas fa-cog"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
</button>
<button class="btn btn-secondary" onclick="lockSession()">
<i class="fas fa-lock"></i> Ù‚ÙÙ„ Ø§Ù„Ø¬Ù„Ø³Ø©
</button>
</div>
</div>
</div>

<script>
let selectedVerifyImage = null;
let selectedSettingsImage = null;

// Ù…ØµÙÙˆÙØ© Ø§Ù„ØµÙˆØ± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©
const naturalImages = [
  {
    url: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø¬Ø¨Ø§Ù„ Ø§Ù„Ø«Ù„Ø¬'
  },
  {
    url: 'https://images.unsplash.com/photo-1464822759844-d150b9014e9e?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ù‚Ù…Ù… Ø§Ù„Ø¬Ø¨Ø§Ù„'
  },
  {
    url: 'https://images.unsplash.com/photo-1519904981063-b0cf448d479e?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø¬Ø¨Ø§Ù„ Ø§Ù„Ø¶Ø¨Ø§Ø¨'
  },
  {
    url: 'https://images.unsplash.com/photo-1533310266094-8898a03807dd?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„ÙˆØ¯ÙŠØ§Ù† Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡'
  },
  {
    url: 'https://images.unsplash.com/photo-1540979388789-6cee28a1cdc9?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø¬Ø¨Ø§Ù„ Ø§Ù„ØºØ±ÙˆØ¨'
  },
  {
    url: 'https://images.unsplash.com/photo-1454391304352-2bf4678b1a7a?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„Ù…Ø±ØªÙØ¹Ø§Øª Ø§Ù„ØµØ®Ø±ÙŠØ©'
  },
  {
    url: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„ØºØ§Ø¨Ø§Øª Ø§Ù„Ù…Ø·ÙŠØ±Ø©'
  },
  {
    url: 'https://images.unsplash.com/photo-1440342359743-84fcb8c21f21?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø£Ø´Ø¬Ø§Ø± Ø§Ù„ØµÙ†ÙˆØ¨Ø±'
  },
  {
    url: 'https://images.unsplash.com/photo-1574263867128-dd9a5af88cff?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ù…Ù…Ø± Ø§Ù„ØºØ§Ø¨Ø©'
  },
  {
    url: 'https://images.unsplash.com/photo-1511593358241-7eea1f3c84e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„ØºØ§Ø¨Ø© Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡'
  },
  {
    url: 'https://images.unsplash.com/photo-1505142468610-359e7d316be0?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„Ø´Ø§Ø·Ø¦ Ø§Ù„Ø°Ù‡Ø¨ÙŠ'
  },
  {
    url: 'https://images.unsplash.com/photo-1439066615861-d1af74d74000?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø£Ù…ÙˆØ§Ø¬ Ø§Ù„Ù…Ø­ÙŠØ·'
  },
  {
    url: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ù‡Ø§Ø¯Ø¦'
  },
  {
    url: 'https://images.unsplash.com/photo-1476673160081-cf065607f449?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„Ø¬Ø²Ø± Ø§Ù„Ø§Ø³ØªÙˆØ§Ø¦ÙŠØ©'
  },
  {
    url: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„Ø´Ø¹Ø§Ø¨ Ø§Ù„Ù…Ø±Ø¬Ø§Ù†ÙŠØ©'
  },
  {
    url: 'https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø£Ø´Ø¬Ø§Ø± Ø§Ù„Ø®Ø±ÙŠÙ'
  },
  {
    url: 'https://images.unsplash.com/photo-1516736923451-535b262d6ff9?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'ØºØ§Ø¨Ø© Ø§Ù„Ø¨Ø§Ù…Ø¨Ùˆ'
  },
  {
    url: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'ØºØ±ÙˆØ¨ Ø§Ù„Ø¨Ø­Ø±'
  },
  {
    url: 'https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ø§Ù„Ø¬Ø¨Ø§Ù„ Ø§Ù„Ø¨Ø¹ÙŠØ¯Ø©'
  },
  {
    url: 'https://images.unsplash.com/photo-1506142167881-95188f25d5c4?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&h=300',
    name: 'Ù‚Ù…Ù… Ø§Ù„Ø£Ù„Ø¨'
  }
];

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„Ù…Ø¹Ø±Ø¶ - Ù…Ø¹Ø¯Ù‘Ù„ Ù„Ù„ØµÙˆØ± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
function createImageGallery(containerId, isSettings = false) {
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  
  for (let i = 0; i < naturalImages.length; i++) {
    const imageItem = document.createElement('div');
    imageItem.className = 'image-item';
    imageItem.onclick = () => selectImage(i + 1, isSettings);
    
    const img = document.createElement('img');
    img.src = naturalImages[i].url;
    img.alt = naturalImages[i].name;
    img.loading = 'lazy';
    
    const numberDiv = document.createElement('div');
    numberDiv.className = 'image-number';
    numberDiv.textContent = i + 1;
    
    const nameDiv = document.createElement('div');
    nameDiv.className = 'image-name';
    nameDiv.textContent = naturalImages[i].name;
    
    imageItem.appendChild(img);
    imageItem.appendChild(numberDiv);
    imageItem.appendChild(nameDiv);
    imageItem.dataset.imageId = i + 1;
    
    container.appendChild(imageItem);
  }
}

// Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©
function selectImage(imageId, isSettings = false) {
  const galleryId = isSettings ? 'settingsGallery' : 'verifyGallery';
  const container = document.getElementById(galleryId);
  
  // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚
  container.querySelectorAll('.image-item').forEach(item => {
    item.classList.remove('selected');
  });
  
  // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  const selectedItem = container.querySelector(`[data-image-id="${imageId}"]`);
  selectedItem.classList.add('selected');
  
  if (isSettings) {
    selectedSettingsImage = imageId;
  } else {
    selectedVerifyImage = imageId;
  }
}

// Ø¯Ø§Ù„Ø© Ù„Ø­Ø³Ø§Ø¨ Ø¨ØµÙ…Ø© Ù…Ø±ÙƒØ¨Ø© Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
async function calculateCombinedHash(imageId, password) {
  try {
    // Ø¥Ù†Ø´Ø§Ø¡ string Ù…Ø±ÙƒØ¨ Ù…Ù† Ù…Ø¹Ø±Ù Ø§Ù„ØµÙˆØ±Ø© ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    const combinedData = `image_${imageId}_password_${password}`;
    const encoder = new TextEncoder();
    const data = encoder.encode(combinedData);
    
    const hashBuffer = await crypto.subtle.digest("SHA-256", data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
  } catch (error) {
    console.error("Error calculating hash:", error);
    showResult("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "fail");
    return null;
  }
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­
async function verifyKey() {
  if (!selectedVerifyImage) {
    showResult("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§", "fail");
    return;
  }

  const password = document.getElementById("verifyPassword").value;
  if (!password) {
    showResult("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "fail");
    return;
  }

  const storedHash = localStorage.getItem("keynova_combined_hash");

  if (!storedHash) {
    showResult("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ Ù…Ø­ÙÙˆØ¸ØŒ ÙŠØ±Ø¬Ù‰ ØªØ¹ÙŠÙŠÙ† Ù…ÙØªØ§Ø­ Ø£ÙˆÙ„Ù‹Ø§", "warning");
    document.getElementById("settings-content").classList.remove("hidden");
    document.getElementById("no-key-section").classList.add("hidden");
    return;
  }

  showResult("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­...", "warning");

  try {
    const currentHash = await calculateCombinedHash(selectedVerifyImage, password);
    if (!currentHash) return;

    if (currentHash === storedHash) {
      showResult("ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ù†Ø¬Ø§Ø­! Ø§Ù„Ø¬Ù„Ø³Ø© Ù…ÙØ¹Ù„Ø© Ø§Ù„Ø¢Ù†", "success");
      document.getElementById("securedActions").classList.remove("hidden");
      document.getElementById("settings-content").classList.remove("hidden");
      document.getElementById("no-key-section").classList.add("hidden");
      startSessionTimer();
    } else {
      showResult("Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©", "fail");
    }
  } catch (error) {
    console.error("Verification error:", error);
    showResult("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚", "fail");
  }
}

// Ø¯Ø§Ù„Ø© ØªØ¹ÙŠÙŠÙ† Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯
async function setKey() {
  if (!selectedSettingsImage) {
    showResult("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ù„ØªØ¹ÙŠÙŠÙ†Ù‡Ø§ ÙƒÙ…ÙØªØ§Ø­", "fail");
    return;
  }

  const password = document.getElementById("setKeyPassword").value;
  if (!password) {
    showResult("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±", "fail");
    return;
  }

  if (password.length < 4) {
    showResult("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„", "fail");
    return;
  }

  // Ø¥Ù†Ø´Ø§Ø¡ modal ØªØ£ÙƒÙŠØ¯ Ù…Ø®ØµØµ
  const confirmChange = await showConfirmDialog("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙØªØ§Ø­ØŸ Ù„Ù† ØªØªÙ…ÙƒÙ† Ù…Ù† ÙØªØ­ Ø§Ù„Ù‚ÙÙ„ Ø¨Ø¯ÙˆÙ† Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.");
  if (!confirmChange) return;

  try {
    const hash = await calculateCombinedHash(selectedSettingsImage, password);
    if (!hash) return;

    localStorage.setItem("keynova_combined_hash", hash);
    showResult("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­", "success");
    
    // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
    document.getElementById("setKeyPassword").value = '';
    selectedSettingsImage = null;
    document.querySelectorAll('#settingsGallery .image-item').forEach(item => {
      item.classList.remove('selected');
    });
  } catch (error) {
    console.error("Error setting key:", error);
    showResult("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­", "fail");
  }
}

// Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØªØ§Ø­
async function removeKey() {
  if (!localStorage.getItem("keynova_combined_hash")) {
    showResult("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ Ù…Ø­ÙÙˆØ¸", "fail");
    return;
  }

  const confirmDelete = await showConfirmDialog("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØªØ§Ø­ØŸ Ù„Ù† ØªØªÙ…ÙƒÙ† Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙÙ„ Ø¨Ø¹Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.");
  if (!confirmDelete) return;

  localStorage.removeItem("keynova_combined_hash");
  localStorage.removeItem("protected_target");
  document.getElementById("securedActions").classList.add("hidden");
  document.getElementById("settings-content").classList.add("hidden");
  document.getElementById("no-key-section").classList.remove("hidden");
  showResult("ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØªØ§Ø­ Ø¨Ù†Ø¬Ø§Ø­", "success");
}

// Ø¯Ø§Ù„Ø© Ø¥Ù†Ø´Ø§Ø¡ modal ØªØ£ÙƒÙŠØ¯ Ù…Ø®ØµØµ
function showConfirmDialog(message) {
  return new Promise((resolve) => {
    const modal = document.createElement('div');
    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    modal.style.cssText = `
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    `;
    
    modal.innerHTML = `
      <div style="
        background: var(--dark-light);
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        max-width: 400px;
        width: 90%;
        text-align: center;
        border: 1px solid rgba(255, 255, 255, 0.1);
      ">
        <i class="fas fa-question-circle" style="font-size: 48px; color: var(--warning); margin-bottom: 20px;"></i>
        <p style="color: var(--light); margin-bottom: 30px; font-size: 16px; line-height: 1.5;">${message}</p>
        <div style="display: flex; gap: 15px; justify-content: center;">
          <button id="cancelBtn" style="
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
          ">Ø¥Ù„ØºØ§Ø¡</button>
          <button id="confirmBtn" style="
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
          ">ØªØ£ÙƒÙŠØ¯</button>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    
    modal.querySelector('#cancelBtn').onclick = () => {
      document.body.removeChild(modal);
      resolve(false);
    };
    
    modal.querySelector('#confirmBtn').onclick = () => {
      document.body.removeChild(modal);
      resolve(true);
    };
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    modal.onclick = (e) => {
      if (e.target === modal) {
        document.body.removeChild(modal);
        resolve(false);
      }
    };
  });
}

// Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…Ø­Ø¯Ø¯
function protectSelected() {
  const target = document.getElementById("protectedTarget").value;
  
  if (!target) {
    showResult("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù‡Ø¯Ù Ù„Ù„Ø­Ù…Ø§ÙŠØ©", "fail");
    return;
  }

  localStorage.setItem("protected_target", target);
  showResult(`ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¹Ù„Ù‰: ${getTargetName(target)}`, "success");
}

// Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ù…Ø§ÙŠØ©
function clearProtection() {
  if (!localStorage.getItem("protected_target")) {
    showResult("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ù…Ø§ÙŠØ© Ù…ÙØ¹Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹", "fail");
    return;
  }

  localStorage.removeItem("protected_target");
  showResult("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­", "success");
}

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
function openTab(tabName) {
  // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
  document.querySelectorAll('.tab-content').forEach(tab => {
    tab.classList.remove('active-tab');
  });

  // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
  document.getElementById(tabName).classList.add('active-tab');

  // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.classList.remove('active');
  });

  event.currentTarget.classList.add('active');
}

// Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
function showResult(message, type) {
  const resultDiv = document.getElementById("result");
  resultDiv.textContent = message;
  resultDiv.className = "result " + type;
}

// Ø¨Ø¯Ø¡ Ù…Ø¤Ù‚Øª Ø§Ù„Ø¬Ù„Ø³Ø©
function startSessionTimer() {
  let timeLeft = 600; // 10 Ø¯Ù‚Ø§Ø¦Ù‚ Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  const timerElement = document.getElementById("sessionTimer");

  const timer = setInterval(() => {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;

    timerElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

    if (timeLeft <= 0) {
      clearInterval(timer);
      lockSession();
    } else {
      timeLeft--;
    }
  }, 1000);
}

// Ù‚ÙÙ„ Ø§Ù„Ø¬Ù„Ø³Ø©
function lockSession() {
  document.getElementById("securedActions").classList.add("hidden");
  document.getElementById("settings-content").classList.add("hidden");
  document.getElementById("no-key-section").classList.remove("hidden");
  showResult("Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù‚Ù‚", "warning");
  
  // Ù…Ø³Ø­ Ø§Ù„ØªØ­Ø¯ÙŠØ¯Ø§Øª
  selectedVerifyImage = null;
  selectedSettingsImage = null;
  document.getElementById("verifyPassword").value = '';
  document.querySelectorAll('.image-item').forEach(item => {
    item.classList.remove('selected');
  });
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù‡Ø¯Ù
function getTargetName(target) {
  const targets = {
    'images': 'Ø§Ù„ØµÙˆØ±',
    'docs': 'Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª',
    'apps': 'Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª',
    'custom': 'Ù…Ø®ØµØµ'
  };
  return targets[target] || target;
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
window.onload = function() {
  // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø§Ø±Ø¶ Ø§Ù„ØµÙˆØ±
  createImageGallery('verifyGallery', false);
  createImageGallery('settingsGallery', true);
  
  // ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¥Ù† ÙˆØ¬Ø¯Øª
  const storedTarget = localStorage.getItem("protected_target");
  if (storedTarget) {
    document.getElementById("protectionStatus").textContent = `Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…ÙØ¹Ù‘Ù„Ø© Ø¹Ù„Ù‰: ${getTargetName(storedTarget)}`;
    document.getElementById("protectionStatus").className = "result success";
  }

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…ÙØªØ§Ø­
  const hasKey = localStorage.getItem("keynova_combined_hash") !== null;

  if (hasKey) {
    document.getElementById("settings-content").classList.add("hidden");
    document.getElementById("no-key-section").classList.add("hidden");
  } else {
    document.getElementById("settings-content").classList.remove("hidden");
    document.getElementById("no-key-section").classList.remove("hidden");
  }
};
</script>
</body>
</html>
