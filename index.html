<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Keynova Lock - Ù‚ÙÙ„ Ø¨ØµØ±ÙŠ Ø¢Ù…Ù†</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&family=Noto+Kufi+Arabic:wght@400;600;700;800&family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --primary: #e8740c;
  --primary-light: #ff9d3d;
  --primary-glow: rgba(232,116,12,0.25);
  --primary-soft: rgba(232,116,12,0.08);
  --accent: #6366f1;
  --accent-soft: rgba(99,102,241,0.1);
  --bg: #07090f;
  --bg-raised: #0d1117;
  --bg-card: #131921;
  --bg-input: #1a2030;
  --bg-hover: #1e2738;
  --border: rgba(255,255,255,0.06);
  --border-hover: rgba(255,255,255,0.12);
  --text: #e8ecf4;
  --text-secondary: #8b95a8;
  --text-dim: #5a6478;
  --success: #22c55e;
  --success-soft: rgba(34,197,94,0.1);
  --danger: #ef4444;
  --danger-soft: rgba(239,68,68,0.1);
  --warning: #f59e0b;
  --warning-soft: rgba(245,158,11,0.1);
  --info: #3b82f6;
  --info-soft: rgba(59,130,246,0.1);
  --radius-xl: 20px;
  --radius-lg: 14px;
  --radius-md: 10px;
  --radius-sm: 8px;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
  --shadow-md: 0 4px 16px rgba(0,0,0,0.3);
  --shadow-lg: 0 12px 40px rgba(0,0,0,0.4);
  --ease: cubic-bezier(0.4,0,0.2,1);
  --font: 'IBM Plex Sans Arabic','Almarai',sans-serif;
  --font-display: 'Noto Kufi Arabic','Almarai',sans-serif;
}

html.light {
  --bg: #f4f6fb;
  --bg-raised: #ffffff;
  --bg-card: #ffffff;
  --bg-input: #f0f2f8;
  --bg-hover: #e8ebf2;
  --border: rgba(0,0,0,0.07);
  --border-hover: rgba(0,0,0,0.14);
  --text: #111827;
  --text-secondary: #6b7280;
  --text-dim: #9ca3af;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.06);
  --shadow-md: 0 4px 16px rgba(0,0,0,0.06);
  --shadow-lg: 0 12px 40px rgba(0,0,0,0.08);
}

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:var(--font);
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  direction:rtl;
  overflow-x:hidden;
  line-height:1.65;
  -webkit-font-smoothing:antialiased;
}

body::before{
  content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background:
    radial-gradient(ellipse 50% 40% at 15% 5%,rgba(232,116,12,0.06),transparent),
    radial-gradient(ellipse 40% 50% at 85% 90%,rgba(99,102,241,0.04),transparent);
}
html.light body::before{
  background:
    radial-gradient(ellipse 50% 40% at 15% 5%,rgba(232,116,12,0.03),transparent),
    radial-gradient(ellipse 40% 50% at 85% 90%,rgba(99,102,241,0.02),transparent);
}

::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:rgba(232,116,12,0.3);border-radius:3px}

/* â”€â”€ Layout â”€â”€ */
.shell{position:relative;z-index:1;max-width:560px;margin:0 auto;padding:14px 16px 40px}

/* â”€â”€ Header â”€â”€ */
.hdr{text-align:center;padding:20px 0 18px;animation:slideIn .5s var(--ease)}
@keyframes slideIn{from{opacity:0;transform:translateY(-14px)}to{opacity:1;transform:translateY(0)}}

.hdr-logo{
  position:relative;width:76px;height:76px;margin:0 auto 14px;
}
.hdr-logo .ring{
  position:absolute;inset:-5px;border-radius:50%;
  border:2px solid var(--primary);opacity:.2;
  animation:ringPulse 3s ease-in-out infinite;
}
@keyframes ringPulse{0%,100%{transform:scale(1);opacity:.2}50%{transform:scale(1.1);opacity:.08}}

.hdr-logo .icon{
  width:76px;height:76px;border-radius:50%;
  background:linear-gradient(135deg,var(--primary),#c45800);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 6px 20px var(--primary-glow);
  position:relative;
}
.hdr-logo .icon i{font-size:30px;color:#fff}

.hdr h1{
  font-family:var(--font-display);font-size:26px;font-weight:800;
  background:linear-gradient(135deg,var(--primary-light),var(--primary));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  background-clip:text;margin-bottom:2px;
}
.hdr .sub{font-size:13px;color:var(--text-secondary)}
.hdr .cred{font-size:11px;color:var(--text-dim);margin-top:2px}

/* â”€â”€ Session Banner â”€â”€ */
.session-banner{
  display:none;align-items:center;gap:10px;
  padding:10px 14px;margin-bottom:14px;
  background:var(--success-soft);border:1px solid rgba(34,197,94,.18);
  border-radius:var(--radius-md);animation:fadeUp .3s var(--ease);
}
.session-banner.on{display:flex}
.session-dot{width:8px;height:8px;border-radius:50%;background:var(--success);animation:blink 1.4s ease-in-out infinite;flex-shrink:0}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.25}}
@keyframes fadeUp{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

.session-banner .s-text{flex:1;font-size:12px;color:var(--text-secondary)}
.session-banner .s-time{font-weight:700;color:var(--success);font-size:14px;font-variant-numeric:tabular-nums}
.session-banner .s-lock{
  background:none;border:1px solid var(--border);color:var(--text-secondary);
  padding:5px 10px;border-radius:6px;cursor:pointer;font-size:12px;
  font-family:var(--font);transition:.2s var(--ease);
}
.session-banner .s-lock:hover{border-color:var(--danger);color:var(--danger)}

/* â”€â”€ Tabs â”€â”€ */
.tabs{
  display:flex;gap:3px;padding:3px;margin-bottom:16px;
  background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);
  animation:slideIn .5s var(--ease) .05s both;
}
.tab{
  flex:1;display:flex;align-items:center;justify-content:center;gap:5px;
  padding:11px 6px;background:transparent;color:var(--text-dim);
  border:none;border-radius:var(--radius-md);cursor:pointer;
  font-family:var(--font);font-size:13px;font-weight:600;
  transition:.25s var(--ease);white-space:nowrap;
}
.tab i{font-size:13px}
.tab:hover{color:var(--text);background:var(--bg-hover)}
.tab.on{background:linear-gradient(135deg,var(--primary),#c45800);color:#fff;box-shadow:0 3px 12px var(--primary-glow)}

/* â”€â”€ Pane â”€â”€ */
.pane{display:none;animation:fadeUp .35s var(--ease)}
.pane.on{display:block}

/* â”€â”€ Card â”€â”€ */
.card{
  background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--radius-lg);padding:20px;
  margin-bottom:14px;box-shadow:var(--shadow-md);
  transition:.25s var(--ease);
}
.card:hover{border-color:var(--border-hover)}

.card-hd{display:flex;align-items:center;gap:10px;margin-bottom:16px}
.card-hd .badge-icon{
  width:34px;height:34px;border-radius:var(--radius-sm);
  display:flex;align-items:center;justify-content:center;
  font-size:15px;flex-shrink:0;
}
.card-hd h3{font-size:16px;font-weight:700;color:var(--text)}
.bg-orange{background:var(--primary-soft);color:var(--primary)}
.bg-green{background:var(--success-soft);color:var(--success)}
.bg-blue{background:var(--info-soft);color:var(--info)}
.bg-red{background:var(--danger-soft);color:var(--danger)}

/* â”€â”€ Form â”€â”€ */
.field-label{font-size:12px;font-weight:600;color:var(--primary-light);margin-bottom:6px;display:block}
.inp-wrap{position:relative;margin-bottom:14px}
.inp-wrap input{
  width:100%;padding:12px 14px 12px 42px;
  background:var(--bg-input);border:1px solid var(--border);
  border-radius:var(--radius-sm);color:var(--text);
  font-family:var(--font);font-size:16px;outline:none;
  transition:.25s var(--ease);
}
.inp-wrap input:focus{border-color:var(--primary);box-shadow:0 0 0 3px var(--primary-glow)}
.inp-wrap input::placeholder{color:var(--text-dim);font-size:14px}

.inp-eye{
  position:absolute;left:10px;top:50%;transform:translateY(-50%);
  background:none;border:none;color:var(--text-dim);cursor:pointer;
  font-size:17px;padding:3px;transition:.2s;
}
.inp-eye:hover{color:var(--primary)}

/* strength */
.str-bar{height:3px;border-radius:2px;background:var(--bg-input);margin-top:6px;overflow:hidden}
.str-fill{height:100%;border-radius:2px;width:0;transition:.35s var(--ease)}
.str-text{font-size:11px;margin-top:3px;color:var(--text-dim);transition:.3s}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   IMAGE GALLERY â€” Redesigned
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.gallery-head{
  display:flex;align-items:center;justify-content:space-between;
  margin-bottom:8px;
}
.gallery-head .sel-info{
  font-size:12px;color:var(--text-dim);
  display:flex;align-items:center;gap:4px;
}
.gallery-head .sel-info.active{color:var(--primary)}
.gallery-head .sel-info i{font-size:11px}

.gallery-scroll{
  max-height:380px;
  overflow-y:auto;
  overflow-x:hidden;
  padding:6px;
  background:var(--bg-input);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  scroll-behavior:smooth;
  -webkit-overflow-scrolling:touch;
}

.gallery-grid{
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  gap:10px;
}

.g-card{
  position:relative;
  border-radius:var(--radius-md);
  overflow:hidden;
  cursor:pointer;
  border:2.5px solid transparent;
  transition:.25s var(--ease);
  background:var(--bg-card);
  box-shadow:var(--shadow-sm);
}

.g-card:hover{
  border-color:rgba(232,116,12,.35);
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(0,0,0,.25);
}

.g-card.selected{
  border-color:var(--primary);
  box-shadow:0 0 0 3px var(--primary-glow), 0 6px 20px rgba(0,0,0,.3);
}

/* Checkmark for selected */
.g-card.selected .g-check{
  opacity:1;transform:scale(1);
}
.g-check{
  position:absolute;top:6px;right:6px;z-index:3;
  width:22px;height:22px;border-radius:50%;
  background:var(--primary);color:#fff;
  display:flex;align-items:center;justify-content:center;
  font-size:10px;
  opacity:0;transform:scale(.5);
  transition:.25s var(--ease);
  box-shadow:0 2px 8px rgba(0,0,0,.3);
}

/* Image wrapper with aspect ratio */
.g-img-wrap{
  position:relative;
  width:100%;
  padding-bottom:100%; /* 1:1 square */
  background:var(--bg-hover);
}
.g-img-wrap img{
  position:absolute;inset:0;
  width:100%;height:100%;
  object-fit:cover;
  display:block;
  transition:transform .3s var(--ease);
}
.g-card:hover .g-img-wrap img{
  transform:scale(1.06);
}

/* Image number label â€” always visible */
.g-label{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:4px;
  padding:7px 4px;
  background:var(--bg-card);
  font-size:12px;
  font-weight:600;
  color:var(--text-secondary);
  border-top:1px solid var(--border);
  transition:.2s;
}
.g-card.selected .g-label{
  color:var(--primary);
  background:var(--primary-soft);
}
.g-label i{font-size:10px;opacity:.5}

/* â”€â”€ Buttons â”€â”€ */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:7px;
  width:100%;padding:12px 18px;border:none;
  border-radius:var(--radius-sm);font-family:var(--font);
  font-size:15px;font-weight:700;cursor:pointer;
  transition:.25s var(--ease);position:relative;overflow:hidden;
}
.btn:active{transform:scale(.97)}

.btn-primary{
  background:linear-gradient(135deg,var(--primary),#c45800);color:#fff;
  box-shadow:0 4px 14px var(--primary-glow);
}
.btn-primary:hover{box-shadow:0 6px 22px var(--primary-glow);transform:translateY(-1px)}

.btn-ghost{background:var(--bg-input);color:var(--text);border:1px solid var(--border)}
.btn-ghost:hover{border-color:var(--primary);color:var(--primary)}

.btn-danger{background:linear-gradient(135deg,var(--danger),#c62828);color:#fff}
.btn-success{background:linear-gradient(135deg,var(--success),#16a34a);color:#fff}
.btn-info{background:linear-gradient(135deg,var(--info),#2563eb);color:#fff}

.btn-sm{padding:9px 14px;font-size:13px}

.btn-row{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px}

/* â”€â”€ Toast â”€â”€ */
.toast-wrap{
  position:fixed;top:14px;left:50%;transform:translateX(-50%);
  z-index:9999;display:flex;flex-direction:column;gap:6px;
  pointer-events:none;width:92%;max-width:440px;
}
.toast{
  display:flex;align-items:center;gap:10px;
  padding:12px 16px;border-radius:var(--radius-sm);
  font-size:13px;font-weight:600;font-family:var(--font);
  direction:rtl;box-shadow:var(--shadow-lg);
  pointer-events:auto;animation:toastIn .35s var(--ease);
  border:1px solid;backdrop-filter:blur(10px);
}
.toast.bye{animation:toastOut .25s ease-in forwards}
@keyframes toastIn{from{opacity:0;transform:translateY(-12px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes toastOut{to{opacity:0;transform:translateY(-12px) scale(.96)}}

.toast-success{background:rgba(13,40,24,.9);border-color:rgba(34,197,94,.25);color:#4ade80}
.toast-error{background:rgba(42,15,15,.9);border-color:rgba(239,68,68,.25);color:#fca5a5}
.toast-warning{background:rgba(42,31,5,.9);border-color:rgba(245,158,11,.25);color:#fbbf24}
.toast-info{background:rgba(12,25,41,.9);border-color:rgba(59,130,246,.25);color:#93c5fd}

html.light .toast-success{background:rgba(240,253,244,.95);color:#166534;border-color:rgba(34,197,94,.2)}
html.light .toast-error{background:rgba(254,242,242,.95);color:#991b1b;border-color:rgba(239,68,68,.2)}
html.light .toast-warning{background:rgba(255,251,235,.95);color:#92400e;border-color:rgba(245,158,11,.2)}
html.light .toast-info{background:rgba(239,246,255,.95);color:#1e40af;border-color:rgba(59,130,246,.2)}

.toast i{font-size:16px;flex-shrink:0}

/* â”€â”€ Lockout â”€â”€ */
.lockout{
  display:none;position:fixed;inset:0;background:rgba(0,0,0,.88);
  z-index:8000;align-items:center;justify-content:center;
  text-align:center;padding:20px;
}
.lockout.on{display:flex}
.lockout-box{
  background:var(--bg-card);border:1px solid rgba(239,68,68,.25);
  border-radius:var(--radius-xl);padding:36px 28px;max-width:360px;width:100%;
}
.lockout-box i{font-size:48px;color:var(--danger);margin-bottom:14px;animation:shake .5s ease}
@keyframes shake{0%,100%{transform:rotate(0)}20%{transform:rotate(-7deg)}40%{transform:rotate(7deg)}60%{transform:rotate(-3deg)}80%{transform:rotate(3deg)}}
.lockout-box h2{color:var(--danger);font-size:20px;margin-bottom:6px}
.lockout-box p{color:var(--text-secondary);font-size:13px;margin-bottom:18px}
.lockout-timer{font-size:32px;font-weight:800;color:var(--text);font-variant-numeric:tabular-nums}

/* â”€â”€ Modal â”€â”€ */
.modal{
  display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);
  z-index:9000;align-items:center;justify-content:center;padding:20px;
}
.modal.on{display:flex}
.modal-box{
  background:var(--bg-card);border:1px solid var(--border);
  border-radius:var(--radius-xl);padding:28px 22px;
  max-width:360px;width:100%;text-align:center;
  box-shadow:var(--shadow-lg);animation:modalPop .3s var(--ease);
}
@keyframes modalPop{from{opacity:0;transform:scale(.92) translateY(8px)}to{opacity:1;transform:scale(1) translateY(0)}}
.modal-box .m-icon{font-size:40px;color:var(--warning);margin-bottom:14px}
.modal-box .m-msg{font-size:14px;color:var(--text);line-height:1.6;margin-bottom:20px}
.modal-btns{display:flex;gap:8px;justify-content:center}
.modal-btns .btn{width:auto;min-width:95px}

/* â”€â”€ Info Box â”€â”€ */
.info-box{
  background:var(--bg-input);border-radius:var(--radius-md);
  padding:14px;margin-top:14px;border-right:3px solid var(--primary);
}
.info-box h4{font-size:13px;color:var(--primary);margin-bottom:8px;display:flex;align-items:center;gap:5px}
.info-box ul{padding-right:14px;margin:0}
.info-box li{font-size:12px;color:var(--text-secondary);margin-bottom:5px;line-height:1.5}

/* â”€â”€ Attempts â”€â”€ */
.attempts{
  display:none;align-items:center;gap:7px;
  padding:9px 12px;background:var(--danger-soft);
  border:1px solid rgba(239,68,68,.18);border-radius:var(--radius-sm);
  font-size:12px;color:var(--danger);margin-top:10px;
}
.attempts.on{display:flex}
.attempts i{font-size:14px}

/* â”€â”€ Protected Items â”€â”€ */
.prot-list{list-style:none;margin-top:10px}
.prot-item{
  display:flex;align-items:center;gap:9px;
  padding:9px 11px;background:var(--bg-input);
  border:1px solid var(--border);border-radius:var(--radius-sm);
  margin-bottom:5px;font-size:13px;animation:fadeUp .3s var(--ease);
}
.prot-item .pi{width:30px;height:30px;border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0}
.prot-item .pn{flex:1}.prot-item .pn b{display:block;font-size:12px;font-weight:600}
.prot-item .pn small{font-size:10px;color:var(--text-dim)}
.prot-item .px{background:none;border:none;color:var(--text-dim);cursor:pointer;font-size:13px;padding:3px;transition:.2s}
.prot-item .px:hover{color:var(--danger)}

.add-row{display:flex;gap:6px;margin-top:10px}
.add-row input,.add-row select{
  flex:1;padding:9px 10px;background:var(--bg-input);
  border:1px solid var(--border);border-radius:var(--radius-sm);
  color:var(--text);font-family:var(--font);font-size:14px;outline:none;
  transition:.2s;
}
.add-row input:focus,.add-row select:focus{border-color:var(--primary)}
.add-row select{flex:.55;cursor:pointer}
.add-row select option{background:var(--bg-card)}
.add-plus{
  background:var(--primary);color:#fff;border:none;
  border-radius:var(--radius-sm);padding:9px 13px;cursor:pointer;
  font-size:15px;transition:.2s;flex-shrink:0;
}
.add-plus:hover{background:#c45800}

/* â”€â”€ Stats â”€â”€ */
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:12px}
.stat{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius-sm);padding:12px 8px;text-align:center}
.stat .num{font-size:20px;font-weight:800;color:var(--primary)}
.stat .lbl{font-size:10px;color:var(--text-dim);margin-top:1px}

/* â”€â”€ Log â”€â”€ */
.log-list{list-style:none;max-height:220px;overflow-y:auto}
.log-e{
  display:flex;align-items:flex-start;gap:9px;
  padding:7px 0;border-bottom:1px solid var(--border);font-size:12px;
}
.log-e:last-child{border-bottom:none}
.log-d{width:7px;height:7px;border-radius:50%;margin-top:5px;flex-shrink:0}
.log-m{flex:1;color:var(--text)}
.log-t{color:var(--text-dim);font-size:10px;white-space:nowrap}

/* â”€â”€ Export â”€â”€ */
.exp-area{margin-top:14px}
.key-box{
  display:none;padding:10px 12px;background:var(--bg-input);
  border:1px solid var(--border);border-radius:var(--radius-sm);
  font-size:11px;word-break:break-all;color:var(--text-dim);
  margin-top:6px;font-family:monospace;direction:ltr;text-align:left;
  position:relative;
}
.key-box.on{display:block}
.key-box .cp-btn{
  position:absolute;top:5px;right:5px;background:var(--primary);
  color:#fff;border:none;border-radius:5px;padding:3px 8px;
  font-size:10px;cursor:pointer;font-family:var(--font);transition:.2s;
}
.key-box .cp-btn:hover{background:#c45800}

.imp-row{display:flex;gap:6px;margin-top:10px}
.imp-row input{
  flex:1;padding:9px 10px;background:var(--bg-input);
  border:1px solid var(--border);border-radius:var(--radius-sm);
  color:var(--text);font-family:monospace;font-size:12px;
  outline:none;direction:ltr;transition:.2s;
}
.imp-row input:focus{border-color:var(--primary)}

/* â”€â”€ Empty â”€â”€ */
.empty{text-align:center;padding:28px 14px;color:var(--text-dim)}
.empty i{font-size:36px;margin-bottom:10px;opacity:.35;display:block}
.empty p{font-size:13px;line-height:1.5}

/* â”€â”€ Responsive â”€â”€ */
@media(max-width:480px){
  .shell{padding:10px 12px 30px}
  .card{padding:16px}
  .gallery-grid{grid-template-columns:repeat(3,1fr);gap:8px}
  .btn-row{grid-template-columns:1fr}
  .tabs .tab{font-size:11px;padding:10px 4px}
  .tabs .tab i{font-size:12px}
  .modal-btns{flex-direction:column}
  .modal-btns .btn{width:100%}
  .stats .stat{padding:10px 6px}
  .stats .num{font-size:17px}
}
@media(max-width:360px){
  .gallery-grid{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>
<body>

<div class="toast-wrap" id="toastWrap"></div>

<div class="lockout" id="lockoutEl">
  <div class="lockout-box">
    <i class="fas fa-ban"></i>
    <h2>ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª</h2>
    <p>ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ÙØ§Ø´Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±.</p>
    <div class="lockout-timer" id="lockoutTimer">02:00</div>
  </div>
</div>

<div class="modal" id="modalEl">
  <div class="modal-box">
    <div class="m-icon"><i class="fas fa-exclamation-triangle"></i></div>
    <p class="m-msg" id="modalMsg"></p>
    <div class="modal-btns">
      <button class="btn btn-ghost btn-sm" id="modalNo">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="btn btn-primary btn-sm" id="modalYes">ØªØ£ÙƒÙŠØ¯</button>
    </div>
  </div>
</div>

<div class="shell">
  <!-- Header -->
  <header class="hdr">
    <div class="hdr-logo">
      <div class="ring"></div>
      <div class="icon"><i class="fas fa-fingerprint"></i></div>
    </div>
    <h1>Keynova Lock</h1>
    <p class="sub">Ù‚ÙÙ„ Ø¨ØµØ±ÙŠ Ø¢Ù…Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙˆØ± ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</p>
    <p class="cred">Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…: Ø±Ø£ÙØª Ø¹Ù…Ø±</p>
  </header>

  <!-- Session Banner -->
  <div class="session-banner" id="sessBanner">
    <div class="session-dot"></div>
    <span class="s-text">Ø§Ù„Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø©</span>
    <span class="s-time" id="sessTime">10:00</span>
    <button class="s-lock" id="sessLock"><i class="fas fa-lock"></i> Ù‚ÙÙ„</button>
  </div>

  <!-- Tabs -->
  <nav class="tabs" id="tabsNav">
    <button class="tab on" data-t="unlock"><i class="fas fa-unlock-alt"></i> ÙØªØ­ Ø§Ù„Ù‚ÙÙ„</button>
    <button class="tab" data-t="settings"><i class="fas fa-sliders-h"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    <button class="tab" data-t="log"><i class="fas fa-list-ul"></i> Ø§Ù„Ø³Ø¬Ù„</button>
  </nav>

  <!-- â•â•â• UNLOCK â•â•â• -->
  <div class="pane on" id="p-unlock">
    <div class="card">
      <div class="card-hd">
        <span class="badge-icon bg-orange"><i class="fas fa-key"></i></span>
        <h3>ÙØªØ­ Ø§Ù„Ù‚ÙÙ„</h3>
      </div>

      <div class="gallery-head">
        <label class="field-label" style="margin:0">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø©</label>
        <span class="sel-info" id="vSel"><i class="fas fa-image"></i> Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</span>
      </div>
      <div class="gallery-scroll">
        <div class="gallery-grid" id="vGallery"></div>
      </div>

      <div style="margin-top:14px">
        <label class="field-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <div class="inp-wrap">
          <input type="password" id="vPass" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" autocomplete="off">
          <button class="inp-eye" data-for="vPass" aria-label="Ø¹Ø±Ø¶"><i class="fas fa-eye"></i></button>
        </div>
      </div>

      <button class="btn btn-primary" id="verifyBtn"><i class="fas fa-shield-alt"></i> ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­</button>

      <div class="attempts" id="attBox"><i class="fas fa-exclamation-triangle"></i><span id="attText"></span></div>
    </div>

    <div class="info-box">
      <h4><i class="fas fa-lightbulb"></i> ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h4>
      <ul>
        <li>Ø§Ø®ØªØ± Ù†ÙØ³ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡Ø§ ÙƒÙ…ÙØªØ§Ø­ Ø£Ø³Ø§Ø³ÙŠ</li>
        <li>Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„ØµØ­ÙŠØ­Ø© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„ØµÙˆØ±Ø©</li>
        <li>Ø¨Ø¹Ø¯ 5 Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙØ§Ø´Ù„Ø© Ø³ÙŠØªÙ… Ø­Ø¸Ø±Ùƒ Ù„Ù…Ø¯Ø© Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†</li>
        <li>Ø§Ù„Ø¬Ù„Ø³Ø© ØªÙ†ØªÙ‡ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 10 Ø¯Ù‚Ø§Ø¦Ù‚</li>
      </ul>
    </div>
  </div>

  <!-- â•â•â• SETTINGS â•â•â• -->
  <div class="pane" id="p-settings">
    <div class="card" id="noKeyBox" style="display:none">
      <div class="empty">
        <i class="fas fa-key"></i>
        <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ Ù…Ø­ÙÙˆØ¸<br>Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„</p>
      </div>
    </div>

    <div class="card" id="setKeyCard">
      <div class="card-hd">
        <span class="badge-icon bg-orange"><i class="fas fa-key"></i></span>
        <h3 id="keyTitle">ØªØ¹ÙŠÙŠÙ† Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯</h3>
      </div>

      <div class="gallery-head">
        <label class="field-label" style="margin:0">Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø§Ù„Ù…ÙØªØ§Ø­</label>
        <span class="sel-info" id="sSel"><i class="fas fa-image"></i> Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</span>
      </div>
      <div class="gallery-scroll">
        <div class="gallery-grid" id="sGallery"></div>
      </div>

      <div style="margin-top:14px">
        <label class="field-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <div class="inp-wrap">
          <input type="password" id="sPass" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ© (4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)" autocomplete="off">
          <button class="inp-eye" data-for="sPass" aria-label="Ø¹Ø±Ø¶"><i class="fas fa-eye"></i></button>
        </div>
        <div class="str-bar"><div class="str-fill" id="strFill"></div></div>
        <div class="str-text" id="strText"></div>
      </div>

      <button class="btn btn-primary" id="setKeyBtn" style="margin-top:6px"><i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­</button>

      <div class="btn-row">
        <button class="btn btn-danger btn-sm" id="rmKeyBtn"><i class="fas fa-trash-alt"></i> Ø¥Ø²Ø§Ù„Ø©</button>
        <button class="btn btn-ghost btn-sm" id="expBtn"><i class="fas fa-download"></i> ØªØµØ¯ÙŠØ±</button>
      </div>

      <div class="exp-area">
        <div class="key-box" id="keyBox">
          <button class="cp-btn" id="cpBtn"><i class="fas fa-copy"></i> Ù†Ø³Ø®</button>
          <span id="keyTxt"></span>
        </div>
      </div>

      <div class="imp-row">
        <input type="text" id="impIn" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…ÙØµØ¯Ù‘Ø± Ù‡Ù†Ø§...">
        <button class="btn btn-info btn-sm" id="impBtn" style="width:auto;min-width:75px"><i class="fas fa-upload"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
      </div>
    </div>

    <div class="card" id="protCard">
      <div class="card-hd">
        <span class="badge-icon bg-green"><i class="fas fa-shield-alt"></i></span>
        <h3>Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø­Ù…ÙŠØ©</h3>
      </div>

      <div class="stats">
        <div class="stat"><div class="num" id="nFiles">0</div><div class="lbl">Ù…Ù„ÙØ§Øª</div></div>
        <div class="stat"><div class="num" id="nApps">0</div><div class="lbl">ØªØ·Ø¨ÙŠÙ‚Ø§Øª</div></div>
        <div class="stat"><div class="num" id="nSites">0</div><div class="lbl">Ù…ÙˆØ§Ù‚Ø¹</div></div>
      </div>

      <ul class="prot-list" id="protList"></ul>

      <div class="add-row">
        <input type="text" id="addName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±...">
        <select id="addType">
          <option value="file">ğŸ“ Ù…Ù„Ù</option>
          <option value="app">ğŸ“± ØªØ·Ø¨ÙŠÙ‚</option>
          <option value="site">ğŸŒ Ù…ÙˆÙ‚Ø¹</option>
        </select>
        <button class="add-plus" id="addBtn" title="Ø¥Ø¶Ø§ÙØ©"><i class="fas fa-plus"></i></button>
      </div>
    </div>
  </div>

  <!-- â•â•â• LOG â•â•â• -->
  <div class="pane" id="p-log">
    <div class="card">
      <div class="card-hd">
        <span class="badge-icon bg-blue"><i class="fas fa-clipboard-list"></i></span>
        <h3>Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·</h3>
      </div>
      <ul class="log-list" id="logUl">
        <li class="empty" id="logNone"><i class="fas fa-inbox"></i><p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ù…Ø³Ø¬Ù„ Ø¨Ø¹Ø¯</p></li>
      </ul>
      <button class="btn btn-ghost btn-sm" id="clrLog" style="margin-top:10px"><i class="fas fa-eraser"></i> Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
    </div>
  </div>

</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   KEYNOVA LOCK â€” SaaS Enhanced
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

var S = {
  hash: null,
  items: [],
  logs: [],
  vImg: null,
  sImg: null,
  sessOn: false,
  sessTid: null,
  sessSec: 0,
  fails: 0,
  maxFails: 5,
  lockSec: 120,
  lockTid: null,
  lockUntil: 0
};

var IMG_BASE = 'https://alkasm1.github.io/keynova-lock2/images/';
var IMG_N = 28;
function imgUrl(i){ return IMG_BASE + 'image' + i + '.jpg'; }

/* â”€â”€ Theme â”€â”€ */
(function(){
  if(window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches){
    document.documentElement.classList.add('light');
  }
  window.matchMedia('(prefers-color-scheme: light)').addEventListener('change',function(e){
    document.documentElement.classList.toggle('light', e.matches);
  });
})();

/* â”€â”€ Toast â”€â”€ */
function toast(msg, type){
  type = type || 'info';
  var ic = {success:'fa-check-circle',error:'fa-times-circle',warning:'fa-exclamation-triangle',info:'fa-info-circle'};
  var el = document.createElement('div');
  el.className = 'toast toast-' + type;
  el.innerHTML = '<i class="fas ' + (ic[type]||ic.info) + '"></i><span>' + msg + '</span>';
  document.getElementById('toastWrap').appendChild(el);
  setTimeout(function(){ el.classList.add('bye'); setTimeout(function(){ if(el.parentNode) el.parentNode.removeChild(el); },250); },3200);
}

/* â”€â”€ Confirm â”€â”€ */
function ask(msg){
  return new Promise(function(res){
    var ov = document.getElementById('modalEl');
    document.getElementById('modalMsg').textContent = msg;
    ov.classList.add('on');
    function done(v){ ov.classList.remove('on'); off(); res(v); }
    function onY(){ done(true); }
    function onN(){ done(false); }
    function onBg(e){ if(e.target===ov) done(false); }
    function off(){
      document.getElementById('modalYes').removeEventListener('click',onY);
      document.getElementById('modalNo').removeEventListener('click',onN);
      ov.removeEventListener('click',onBg);
    }
    document.getElementById('modalYes').addEventListener('click',onY);
    document.getElementById('modalNo').addEventListener('click',onN);
    ov.addEventListener('click',onBg);
  });
}

/* â”€â”€ SHA-256 â”€â”€ */
async function sha(txt){
  var buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(txt));
  return Array.from(new Uint8Array(buf)).map(function(b){return b.toString(16).padStart(2,'0')}).join('');
}
async function makeKey(imgId, pwd){
  var h1 = await sha('keynova_v2_img:'+imgId+'|pwd:'+pwd+'|salt:kn0va2025');
  return sha(h1+':'+pwd.length+':'+imgId);
}

/* â”€â”€ Log â”€â”€ */
function addLog(msg, type){
  type = type||'info';
  S.logs.unshift({msg:msg,type:type,time:new Date().toLocaleTimeString('ar-EG',{hour:'2-digit',minute:'2-digit',second:'2-digit'})});
  if(S.logs.length>50) S.logs.pop();
  drawLog();
}
function drawLog(){
  var ul = document.getElementById('logUl');
  var em = document.getElementById('logNone');
  if(!S.logs.length){ ul.innerHTML=''; ul.appendChild(em); em.style.display=''; return; }
  em.style.display='none';
  var cols={success:'var(--success)',error:'var(--danger)',warning:'var(--warning)',info:'var(--info)'};
  var h='';
  S.logs.forEach(function(e){
    h+='<li class="log-e"><span class="log-d" style="background:'+(cols[e.type]||cols.info)+'"></span><span class="log-m">'+e.msg+'</span><span class="log-t">'+e.time+'</span></li>';
  });
  ul.innerHTML=h; ul.appendChild(em);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GALLERY â€” Clean card-based design
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildGallery(containerId, isSetting){
  var grid = document.getElementById(containerId);
  grid.innerHTML = '';
  for(var i=1; i<=IMG_N; i++){
    (function(idx){
      var card = document.createElement('div');
      card.className = 'g-card';
      card.dataset.idx = idx;

      // Check badge
      var check = document.createElement('div');
      check.className = 'g-check';
      check.innerHTML = '<i class="fas fa-check"></i>';

      // Image wrap
      var wrap = document.createElement('div');
      wrap.className = 'g-img-wrap';
      var img = document.createElement('img');
      img.src = imgUrl(idx);
      img.alt = 'ØµÙˆØ±Ø© ' + idx;
      img.loading = 'lazy';
      img.draggable = false;
      wrap.appendChild(img);

      // Label
      var lbl = document.createElement('div');
      lbl.className = 'g-label';
      lbl.innerHTML = '<i class="fas fa-hashtag"></i> ' + idx;

      card.appendChild(check);
      card.appendChild(wrap);
      card.appendChild(lbl);

      card.addEventListener('click', function(){
        pick(containerId, idx, isSetting);
      });

      grid.appendChild(card);
    })(i);
  }
}

function pick(containerId, idx, isSetting){
  var grid = document.getElementById(containerId);
  grid.querySelectorAll('.g-card').forEach(function(c){ c.classList.remove('selected'); });
  var el = grid.querySelector('[data-idx="'+idx+'"]');
  if(el) el.classList.add('selected');

  var selId = isSetting ? 'sSel' : 'vSel';
  var selEl = document.getElementById(selId);
  selEl.innerHTML = '<i class="fas fa-check-circle"></i> Ø§Ù„ØµÙˆØ±Ø© ' + idx;
  selEl.classList.add('active');

  if(isSetting) S.sImg = idx;
  else S.vImg = idx;
}

/* â”€â”€ Strength â”€â”€ */
function strength(p){
  var s=0;
  if(p.length>=4) s++;
  if(p.length>=8) s++;
  if(p.length>=12) s++;
  if(/[a-z]/.test(p)&&/[A-Z]/.test(p)) s++;
  if(/\d/.test(p)) s++;
  if(/[^a-zA-Z0-9]/.test(p)) s++;
  return Math.min(s,5);
}
function showStr(p){
  var fill=document.getElementById('strFill'), txt=document.getElementById('strText');
  if(!p){fill.style.width='0';txt.textContent='';return;}
  var s=strength(p);
  var lv=[
    {w:'20%',c:'#ef4444',t:'Ø¶Ø¹ÙŠÙØ© Ø¬Ø¯Ø§Ù‹'},
    {w:'40%',c:'#f97316',t:'Ø¶Ø¹ÙŠÙØ©'},
    {w:'60%',c:'#eab308',t:'Ù…ØªÙˆØ³Ø·Ø©'},
    {w:'80%',c:'#22c55e',t:'Ù‚ÙˆÙŠØ©'},
    {w:'100%',c:'#10b981',t:'Ù‚ÙˆÙŠØ© Ø¬Ø¯Ø§Ù‹'}
  ];
  var l=lv[Math.max(0,s-1)]||lv[0];
  fill.style.width=l.w; fill.style.background=l.c;
  txt.textContent=l.t; txt.style.color=l.c;
}

/* â”€â”€ Eye toggle â”€â”€ */
document.addEventListener('click',function(e){
  var btn=e.target.closest('.inp-eye');
  if(!btn) return;
  var inp=document.getElementById(btn.dataset.for);
  if(!inp) return;
  if(inp.type==='password'){inp.type='text';btn.innerHTML='<i class="fas fa-eye-slash"></i>';}
  else{inp.type='password';btn.innerHTML='<i class="fas fa-eye"></i>';}
});

/* â”€â”€ Tabs â”€â”€ */
document.getElementById('tabsNav').addEventListener('click',function(e){
  var t=e.target.closest('.tab');
  if(!t) return;
  var name=t.dataset.t;
  if(name==='settings'&&S.hash&&!S.sessOn){toast('ÙŠØ±Ø¬Ù‰ ÙØªØ­ Ø§Ù„Ù‚ÙÙ„ Ø£ÙˆÙ„Ø§Ù‹','warning');return;}
  document.querySelectorAll('.tab').forEach(function(x){x.classList.remove('on')});
  t.classList.add('on');
  document.querySelectorAll('.pane').forEach(function(x){x.classList.remove('on')});
  document.getElementById('p-'+name).classList.add('on');
});
function goTab(name){
  document.querySelectorAll('.tab').forEach(function(x){x.classList.toggle('on',x.dataset.t===name)});
  document.querySelectorAll('.pane').forEach(function(x){x.classList.remove('on')});
  document.getElementById('p-'+name).classList.add('on');
}

/* â”€â”€ Lockout â”€â”€ */
function startLock(){
  S.lockUntil=Date.now()+S.lockSec*1000;
  var ov=document.getElementById('lockoutEl');
  ov.classList.add('on');
  addLog('ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù„Ù…Ø¯Ø© '+(S.lockSec/60)+' Ø¯Ù‚ÙŠÙ‚Ø©','error');
  function tick(){
    var r=Math.max(0,Math.ceil((S.lockUntil-Date.now())/1000));
    var m=Math.floor(r/60), s=r%60;
    document.getElementById('lockoutTimer').textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
    if(r<=0){clearInterval(S.lockTid);ov.classList.remove('on');S.fails=0;updAtt();addLog('ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø­Ø¸Ø±','info');}
  }
  tick(); S.lockTid=setInterval(tick,1000);
}
function updAtt(){
  var box=document.getElementById('attBox'), txt=document.getElementById('attText');
  if(S.fails>0){box.classList.add('on');txt.textContent='Ù…Ø­Ø§ÙˆÙ„Ø§Øª ÙØ§Ø´Ù„Ø©: '+S.fails+' â€” Ù…ØªØ¨Ù‚ÙŠ '+(S.maxFails-S.fails)+' Ù…Ø­Ø§ÙˆÙ„Ø§Øª';}
  else{box.classList.remove('on');}
}

/* â”€â”€ Verify â”€â”€ */
document.getElementById('verifyBtn').addEventListener('click',async function(){
  if(Date.now()<S.lockUntil){toast('ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª','error');return;}
  if(!S.vImg){toast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹','warning');return;}
  var pw=document.getElementById('vPass').value;
  if(!pw){toast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±','warning');return;}
  if(!S.hash){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ØŒ Ø£Ù†Ø´Ø¦ ÙˆØ§Ø­Ø¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª','warning');goTab('settings');return;}
  toast('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...','info');
  try{
    var h=await makeKey(S.vImg,pw);
    if(h===S.hash){
      S.fails=0;updAtt();startSess();
      toast('ØªÙ… ÙØªØ­ Ø§Ù„Ù‚ÙÙ„ Ø¨Ù†Ø¬Ø§Ø­!','success');addLog('ØªÙ… ÙØªØ­ Ø§Ù„Ù‚ÙÙ„ Ø¨Ù†Ø¬Ø§Ø­','success');
    }else{
      S.fails++;updAtt();addLog('Ù…Ø­Ø§ÙˆÙ„Ø© ÙØ§Ø´Ù„Ø© ('+S.fails+')','error');
      if(S.fails>=S.maxFails){startLock();toast('ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª!','error');}
      else toast('Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©','error');
    }
  }catch(er){toast('Ø­Ø¯Ø« Ø®Ø·Ø£','error');}
});

/* â”€â”€ Session â”€â”€ */
function startSess(){
  S.sessOn=true;S.sessSec=600;
  document.getElementById('sessBanner').classList.add('on');
  updSess();
  if(S.sessTid) clearInterval(S.sessTid);
  S.sessTid=setInterval(function(){
    S.sessSec--;updSess();
    if(S.sessSec<=0){endSess();toast('Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©','warning');addLog('Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹','warning');}
  },1000);
}
function updSess(){
  var m=Math.floor(S.sessSec/60),s=S.sessSec%60;
  document.getElementById('sessTime').textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
}
function endSess(){
  S.sessOn=false;
  if(S.sessTid){clearInterval(S.sessTid);S.sessTid=null;}
  document.getElementById('sessBanner').classList.remove('on');
  S.vImg=null;S.sImg=null;
  document.getElementById('vPass').value='';
  document.getElementById('vSel').innerHTML='<i class="fas fa-image"></i> Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±';
  document.getElementById('vSel').classList.remove('active');
  document.getElementById('sSel').innerHTML='<i class="fas fa-image"></i> Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±';
  document.getElementById('sSel').classList.remove('active');
  document.querySelectorAll('.g-card').forEach(function(c){c.classList.remove('selected')});
  goTab('unlock');
}
document.getElementById('sessLock').addEventListener('click',function(){endSess();toast('ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ø¬Ù„Ø³Ø©','info');addLog('ØªÙ… Ø§Ù„Ù‚ÙÙ„ ÙŠØ¯ÙˆÙŠØ§Ù‹','warning')});

/* â”€â”€ Set Key â”€â”€ */
document.getElementById('setKeyBtn').addEventListener('click',async function(){
  if(!S.sImg){toast('Ø§Ø®ØªØ± ØµÙˆØ±Ø© ÙƒÙ…ÙØªØ§Ø­','warning');return;}
  var pw=document.getElementById('sPass').value;
  if(!pw){toast('Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±','warning');return;}
  if(pw.length<4){toast('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù‚ØµÙŠØ±Ø© (4 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)','warning');return;}
  var msg=S.hash?'Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠØŸ':'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­ÙØ¸ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ØŸ ØªØ£ÙƒØ¯ Ù…Ù† ØªØ°ÙƒØ±Ù‡.';
  if(!(await ask(msg))) return;
  try{
    S.hash=await makeKey(S.sImg,pw);
    toast('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø¨Ù†Ø¬Ø§Ø­!','success');addLog('ØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯','success');
    document.getElementById('sPass').value='';showStr('');
    S.sImg=null;
    document.getElementById('sSel').innerHTML='<i class="fas fa-image"></i> Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±';
    document.getElementById('sSel').classList.remove('active');
    document.getElementById('sGallery').querySelectorAll('.g-card').forEach(function(c){c.classList.remove('selected')});
    updState();
  }catch(er){toast('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸','error');}
});

/* â”€â”€ Remove â”€â”€ */
document.getElementById('rmKeyBtn').addEventListener('click',async function(){
  if(!S.hash){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­','warning');return;}
  if(!(await ask('Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØªØ§Ø­ ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù…ÙŠØ©ØŸ'))) return;
  S.hash=null;S.items=[];drawItems();endSess();
  toast('ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØªØ§Ø­','success');addLog('ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙØªØ§Ø­','error');updState();
});

/* â”€â”€ Export â”€â”€ */
document.getElementById('expBtn').addEventListener('click',function(){
  if(!S.hash){toast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­','warning');return;}
  var d=btoa(JSON.stringify({h:S.hash,v:2,t:Date.now()}));
  document.getElementById('keyTxt').textContent=d;
  document.getElementById('keyBox').classList.add('on');
  addLog('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù…ÙØªØ§Ø­','info');
});
document.getElementById('cpBtn').addEventListener('click',function(){
  navigator.clipboard.writeText(document.getElementById('keyTxt').textContent).then(function(){toast('ØªÙ… Ø§Ù„Ù†Ø³Ø®','success')});
});
document.getElementById('impBtn').addEventListener('click',async function(){
  var val=document.getElementById('impIn').value.trim();
  if(!val){toast('Ø§Ù„ØµÙ‚ Ø§Ù„Ù…ÙØªØ§Ø­ Ø£ÙˆÙ„Ø§Ù‹','warning');return;}
  try{
    var d=JSON.parse(atob(val));
    if(!d.h||d.v!==2){toast('Ù…ÙØªØ§Ø­ ØºÙŠØ± ØµØ§Ù„Ø­','error');return;}
    if(!(await ask('Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙØªØ§Ø­ØŸ Ø³ÙŠØ³ØªØ¨Ø¯Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ.'))) return;
    S.hash=d.h;document.getElementById('impIn').value='';
    toast('ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­!','success');addLog('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙØªØ§Ø­','success');updState();
  }catch(er){toast('Ù…ÙØªØ§Ø­ ØºÙŠØ± ØµØ§Ù„Ø­','error');}
});

/* â”€â”€ Protected Items â”€â”€ */
function drawItems(){
  var ul=document.getElementById('protList');ul.innerHTML='';
  var c={file:0,app:0,site:0};
  var ic={file:{i:'fa-file-alt',cl:'bg-blue'},app:{i:'fa-mobile-alt',cl:'bg-orange'},site:{i:'fa-globe',cl:'bg-green'}};
  var tn={file:'Ù…Ù„Ù',app:'ØªØ·Ø¨ÙŠÙ‚',site:'Ù…ÙˆÙ‚Ø¹'};
  S.items.forEach(function(it,idx){
    c[it.type]=(c[it.type]||0)+1;
    var inf=ic[it.type]||ic.file;
    var li=document.createElement('li');li.className='prot-item';
    li.innerHTML='<div class="pi '+inf.cl+'"><i class="fas '+inf.i+'"></i></div><div class="pn"><b>'+it.name+'</b><small>'+(tn[it.type]||it.type)+'</small></div><button class="px" data-i="'+idx+'"><i class="fas fa-times"></i></button>';
    ul.appendChild(li);
  });
  document.getElementById('nFiles').textContent=c.file||0;
  document.getElementById('nApps').textContent=c.app||0;
  document.getElementById('nSites').textContent=c.site||0;
}
document.getElementById('protList').addEventListener('click',function(e){
  var b=e.target.closest('.px');if(!b) return;
  var i=parseInt(b.dataset.i,10),nm=S.items[i]?S.items[i].name:'';
  S.items.splice(i,1);drawItems();
  toast('ØªÙ… Ø¥Ø²Ø§Ù„Ø© "'+nm+'"','info');addLog('Ø¥Ø²Ø§Ù„Ø© "'+nm+'" Ù…Ù† Ø§Ù„Ø­Ù…Ø§ÙŠØ©','warning');
});
document.getElementById('addBtn').addEventListener('click',function(){
  var inp=document.getElementById('addName'),nm=inp.value.trim();
  if(!nm){toast('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù†ØµØ±','warning');return;}
  if(!S.sessOn&&S.hash){toast('Ø§ÙØªØ­ Ø§Ù„Ù‚ÙÙ„ Ø£ÙˆÙ„Ø§Ù‹','warning');return;}
  S.items.push({name:nm,type:document.getElementById('addType').value});
  inp.value='';drawItems();
  toast('ØªÙ… Ø¥Ø¶Ø§ÙØ© "'+nm+'"','success');addLog('Ø¥Ø¶Ø§ÙØ© "'+nm+'" Ù„Ù„Ø­Ù…Ø§ÙŠØ©','success');
});

/* â”€â”€ Clear Log â”€â”€ */
document.getElementById('clrLog').addEventListener('click',async function(){
  if(!S.logs.length){toast('Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº','info');return;}
  if(!(await ask('Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ'))) return;
  S.logs=[];drawLog();toast('ØªÙ… Ø§Ù„Ù…Ø³Ø­','success');
});

/* â”€â”€ State â”€â”€ */
function updState(){
  var noKey=document.getElementById('noKeyBox');
  document.getElementById('keyTitle').textContent=S.hash?'ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙØªØ§Ø­':'Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯';
  noKey.style.display=S.hash?'none':'';
}

/* â”€â”€ Strength listener â”€â”€ */
document.getElementById('sPass').addEventListener('input',function(){showStr(this.value)});

/* â”€â”€ Enter key shortcuts â”€â”€ */
document.getElementById('vPass').addEventListener('keydown',function(e){if(e.key==='Enter') document.getElementById('verifyBtn').click()});
document.getElementById('sPass').addEventListener('keydown',function(e){if(e.key==='Enter') document.getElementById('setKeyBtn').click()});
document.getElementById('addName').addEventListener('keydown',function(e){if(e.key==='Enter') document.getElementById('addBtn').click()});

/* â”€â”€ Init â”€â”€ */
(function(){
  buildGallery('vGallery',false);
  buildGallery('sGallery',true);
  updState();drawItems();drawLog();
  addLog('ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚','info');
})();
</script>
</body>
</html>
